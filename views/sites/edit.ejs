<% layout('/partials/boilerplate') %>

<h1>Edit site submission</h1>

<form action="/sites/<%=site._id%>?_method=PUT" method="POST" novalidate class="needs-validation" enctype="multipart/form-data">
	<div class="form-group">
		<div>
			<label for="">Site name:</label>
			<input
				class="form-control"
				type="text"
				name="site[name]"
				id="site"
				value="<%=site.name%>"
				required
			/>
			<div class="valid-feedback">Perfect!</div>
			<div class="invalid-feedback">Please enter a valid title.</div>
		</div>

		<div>
			<label for="">Location:</label>
			<input
				class="form-control"
				type="text"
				name="site[location]"
				id="location"
				value="<%=site.location%>"
				required
			/>
			<div class="valid-feedback">Perfect!</div>
			<div class="invalid-feedback">Please enter a valid site location.</div>
		</div>
	
		<div>
			<label for="">Price:</label>
			<input
				class="form-control"
				type="text"
				name="site[price]"
				id="price"
				value="<%=site.price%>"
				required
			/>
			<div class="valid-feedback">Perfect!</div>
			<div class="invalid-feedback">Please enter a valid price.</div>
		</div>

	<div>
		<label for="">Description:</label>
		<textarea
			class="form-control rows=3"
			type="text"
			name="site[description]"
			id="description"
			required
		/><%=site.description%></textarea>
		<div class="valid-feedback">Perfect!</div>
		<div class="invalid-feedback">Please enter a valid price.</div>
	</div>

	<div>
		<label for="">Upload new image</label>
		<div class="mt-2">
			<input type="file" name="image" id="image" multiple="true">
			
		</div>
	</div>
	<div>
		<% site.images.forEach(function(img, i) { %>
		 <img src="<%=img.url%>" class="img-thumbnail">
		<div class="form-check-inline">
			<input type="checkbox" name="deleteImages[]" value="<%=img.filename%>" id="image<%=i%>">
			<label for="image<%=i%>">Select for deletion</label>
		</div>

		<% }) %>
	</div>
<br>
		<button type="submit" class="btn btn-primary">Update</button>
	</div>
</form>

<form action="/sites/<%=site._id%>?_method=DELETE" method="POST">
	<button type="submit" class="btn btn-danger">Delete</button>
</form>

<a href="/sites/<%=site._id%>">Return to site information</a>
